#!/usr/bin/sh

TARGET=`realpath ${PASSWORD_STORE_DIR-~/.password-store}`

sed -i '$ d' pmenu/config.py
echo "PASSWORD_STORE_DIR = Path(\"$TARGET\")" >> pmenu/config.py

cat > extension/pmenu.json <<END_HEREDOC
{
  "name": "pmenu",
  "description": "Interface for local password store",
  "path": "$HOME/.local/bin/pmenu-messager",
  "type": "stdio",
  "allowed_extensions": ["david-pmenu@davidbuckley.ca"]
}
END_HEREDOC
